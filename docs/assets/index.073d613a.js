var w=Object.defineProperty;var S=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var x=(e,l,r)=>l in e?w(e,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[l]=r,g=(e,l)=>{for(var r in l||(l={}))P.call(l,r)&&x(e,r,l[r]);if(S)for(var r of S(l))M.call(l,r)&&x(e,r,l[r]);return e};import{b as i,F as k,l as N,d as U,o as L,c as O,a as m,w as z,p as B,e as Y,r as D,f as j,g as Q}from"./vendor.51b4b64a.js";const V=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(t){if(t.ep)return;t.ep=!0;const o=r(t);fetch(t.href,o)}};V();var n={NONE:0,OPEN_TAG:1<<1,CLOSE_TAG:1<<2,SELF_CLOSING:1<<3,ATTR_NAME:1<<4,ATTR_VALUE:1<<5,TEXT:1<<6,COMMENT:1<<7,ONELINE:1<<8,MULTILINE:1<<9,SINGLE_QUOTE:1<<10,DOUBLE_QUOTE:1<<11,STYLE_TAG:1<<12,SCRIPT_TAG:1<<13};const H=function(){var e=document.createElement("div");function l(r){return r&&typeof r=="string"&&(r=r.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,""),r=r.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),e.innerHTML=r,r=e.textContent,e.textContent=""),r}return l}();function X(e,l){var r=0,s=e[r],t=n.TEXT,o=n.NONE,c=n.NONE;function a(p,y){return p.length<=1&&!y?p===s:p===(y||e.substring(r-p.length,r))}function f(p,y){return e.substring(p,y)}function E(p){return p===t}function d(p){return p===o}var u=[0];u.set=function(p){u[u.length-1]=p},u.get=function(){return u[u.length-1]};for(var _=new function(){this[n.TEXT]={enter:function(){d(n.OPEN_TAG|n.CLOSE_TAG)||d(n.STYLE_TAG)||d(n.SCRIPT_TAG)||u.set(r)},exit:function(){var p=f(u.get(),r);!p||l.onText(p)},do:function(){a("<")&&(t=n.OPEN_TAG|n.CLOSE_TAG)}},this[n.OPEN_TAG|n.CLOSE_TAG]={enter:function(){u.push(r)},exit:function(){var p=u.pop();E(n.OPEN_TAG)&&u.set(p)},do:function(){a("!--")?t=n.COMMENT:a("/")?t=n.CLOSE_TAG:a(" ")?t=n.TEXT:!a("!")&&!a("-")&&(t=n.OPEN_TAG)}},this[n.OPEN_TAG]={exit:function(){var p=f(u.get(),r);!p||(p==="style"&&(c=n.STYLE_TAG),p==="script"&&(c=n.SCRIPT_TAG),l.onOpenTag(p))},do:function(){a(">")?t=n.SELF_CLOSING:a(" ")&&(t=n.ATTR_NAME)}},this[n.CLOSE_TAG]={enter:function(){u.set(r)},exit:function(){var p=f(u.get(),r);!p||l.onCloseTag(p)},do:function(){a(">")&&(t=n.TEXT)}},this[n.SELF_CLOSING]={enter:function(){u.push(r)},exit:function(){var p=u.pop();r=p-1,c&n.STYLE_TAG&&(t=n.OPEN_TAG|n.STYLE_TAG),c&n.SCRIPT_TAG&&(t=n.OPEN_TAG|n.SCRIPT_TAG)},do:function(){a("/>",f(r-2,r))?this.mark():this.close(),t=n.TEXT},mark:function(){l.onSelfClose()},close:function(){l.onOpenTagExit()}},this[n.ATTR_NAME]={enter:function(){u.set(r)},exit:function(){if(!a("/",f(r-1,r))){var p=f(u.get(),r);!p||l.onAttrName(p)}},do:function(){a(" ")||a("/")?this.repeat():a(">")?t=n.SELF_CLOSING:a("=")&&(t=n.ATTR_VALUE)},repeat:function(){this.exit(),u.set(r+1)}},this[n.ATTR_VALUE]={enter:function(){a("'")?(t|=n.SINGLE_QUOTE,u.set(r+1)):a('"')?(t|=n.DOUBLE_QUOTE,u.set(r+1)):u.set(r)},exit:function(){var p=f(u.get(r),r);!p||l.onAttrValue(p)},do:function(){a(" ")?t=n.ATTR_NAME:a(">")&&(t=n.SELF_CLOSING)}},this[n.ATTR_VALUE|n.SINGLE_QUOTE]={exit:this[n.ATTR_VALUE].exit,do:function(){a("'")&&(t=n.ATTR_NAME)}},this[n.ATTR_VALUE|n.DOUBLE_QUOTE]={exit:this[n.ATTR_VALUE].exit,do:function(){a('"')&&(t=n.ATTR_NAME)}},this[n.STYLE_TAG]={do:function(){a("/*")?t=n.STYLE_TAG|n.COMMENT:a("'")?t=n.STYLE_TAG|n.SINGLE_QUOTE:a('"')?t=n.STYLE_TAG|n.DOUBLE_QUOTE:a("<")&&a("</style>",f(r,r+8))&&(t=n.TEXT,r--,this.close())},close:function(){var p=u.pop();u.set(p),c^=n.STYLE_TAG}},this[n.OPEN_TAG|n.STYLE_TAG]={enter:function(){u.push(r)},do:this[n.STYLE_TAG].do},this[n.STYLE_TAG|n.COMMENT]={do:function(){a("*/")&&(t=n.STYLE_TAG)}},this[n.STYLE_TAG|n.SINGLE_QUOTE]={do:function(){a("'")&&(t=n.STYLE_TAG)}},this[n.STYLE_TAG|n.DOUBLE_QUOTE]={do:function(){a('"')&&(t=n.STYLE_TAG)}},this[n.SCRIPT_TAG]={do:function(){a("/*")?t=n.SCRIPT_TAG|n.COMMENT|n.MULTILINE:a("//")?t=n.SCRIPT_TAG|n.COMMENT|n.ONELINE:a("'")?t=n.SCRIPT_TAG|n.SINGLE_QUOTE:a('"')?t=n.SCRIPT_TAG|n.DOUBLE_QUOTE:a("`")?t=n.SCRIPT_TAG|n.MULTILINE:a("<")&&a("<\/script>",f(r,r+9))&&(t=n.TEXT,r--,this.close())},close:function(){var p=u.pop();u.set(p),c^=n.SCRIPT_TAG}},this[n.OPEN_TAG|n.SCRIPT_TAG]={enter:function(){u.push(r)},exit:this[n.SCRIPT_TAG].close,do:this[n.SCRIPT_TAG].do},this[n.SCRIPT_TAG|n.COMMENT|n.MULTILINE]={do:function(){a("*/")&&(t=n.SCRIPT_TAG)}},this[n.SCRIPT_TAG|n.COMMENT|n.ONELINE]={do:function(){a(`
`)&&(t=n.SCRIPT_TAG)}},this[n.SCRIPT_TAG|n.SINGLE_QUOTE]={do:function(){a("'")&&(t=n.SCRIPT_TAG)}},this[n.SCRIPT_TAG|n.DOUBLE_QUOTE]={do:function(){a('"')&&(t=n.SCRIPT_TAG)}},this[n.SCRIPT_TAG|n.MULTILINE]={do:function(){a("`")&&(t=n.SCRIPT_TAG)}},this[n.COMMENT]={enter:function(){u.set(r)},exit:function(){var p=f(u.get(),r-2);!p||l.onComment(p)},do:function(){a("-->",f(r-2,r+1))&&(t=n.TEXT)}}},T={},A;r<e.length;r++,s=e[r])A=!1,T=_[t],T&&(o!=t&&T.enter&&T.enter(),o=t,T.do&&(T.do(),t!=o&&T.exit&&(T.exit(),A=!0)));!A&&T.exit&&T.exit()}function v(e){(e.type==="root"||e.type==="node")&&(delete e.parent,delete e.last,e.children&&e.children.forEach(function(l){v(l)}))}function W(e){let l={"!DOCTYPE":!0,"!doctype":!0,area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,circle:!0,ellipse:!0,line:!0,path:!0,polygon:!0,polyline:!0,rect:!0,stop:!0,use:!0},r={type:"root"},s=r,t={};return t.onOpenTag=function(o){var c={type:"node",tagName:o};c.parent=s,s.children||(s.children=[]),s.children.push(c),s=c},t.onOpenTagExit=function(){l[s.tagName]&&(s=s.parent)},t.onCloseTag=function(){s=s.parent},t.onSelfClose=function(){s=s.parent},t.onAttrName=function(o){s.attrs||(s.attrs={}),s.last=o,s.attrs[o]=""},t.onAttrValue=function(o){s.attrs[s.last]=o},t.onText=function(o){s.children||(s.children=[]);var c={type:"text",text:H(o)};s.children.push(c)},t.onComment=function(o){s.children||(s.children=[]);var c={type:"comment",value:o};s.children.push(c)},X(e,t),v(r),r}var $="/public_assets/images/fig1.jpg",q="/public_assets/images/fig2.jpg",J="/public_assets/images/fig3.jpg",K="/public_assets/images/fig4.jpg";const F=[$,q,J,K],h=e=>e==="none"?0:e.includes("cm")?parseInt(e.replace("cm"))*566.9291338583:e.includes("pt")?parseInt(e.replace("pt"))*20:e.includes("px")?parseInt(e.replace("px"))*15:0,b=[{id:"alignment",key:"text-align",isStatic:!0,values:{center:i.exports.AlignmentType.CENTER,left:i.exports.AlignmentType.LEFT,right:i.exports.AlignmentType.RIGHT,justify:i.exports.AlignmentType.JUSTIFIED}},{id:"color",key:"color",isStatic:!1,value:e=>e.replace("#","")},{id:"font",key:"font-family",isStatic:!1,value:e=>e},{id:"size",key:"font-size",isStatic:!1,value:e=>parseFloat(e.replace("pt",""))},{id:"indent",key:"text-indent",isStatic:!1,value:e=>({start:h(e)})},{id:"indent",key:"padding",isStatic:!1,value:e=>{const l=e.split(" ");return{top:h(l[0]),right:h(l[1]),bottom:h(l[2]),left:h(l[3])}}},{id:"shading",key:"background-color",isStatic:!1,value:e=>({type:i.exports.ShadingType.CLEAR,fill:e.replace("#","")})},{id:"width",key:"width",isStatic:!1,value:e=>({size:h(e),type:i.exports.WidthType.DXA})},{id:"spacing",key:"line-height",isStatic:!1,value:e=>({line:typeof e=="string"?240:parseFloat((e*240/100).toFixed(2))})},{id:"borders",key:"border",keys:["border-right","border-left","border-top","border-bottom"],isStatic:!1,value:(e,l="border")=>{const r={top:{style:i.exports.BorderStyle.NONE,size:0},bottom:{style:i.exports.BorderStyle.NONE,size:0},left:{style:i.exports.BorderStyle.NONE,size:0},right:{style:i.exports.BorderStyle.NONE,size:0}};if(l==="border"){if(e==="none")return r}else{const s=l.replace("border-","");let t=0;if(e!=="none"){const o=e.split(" ");t=h(o[2])}return["borders",{style:i.exports.BorderStyle.SINGLE,size:t},s]}}}],Z=(e,l)=>{const r=b.find(t=>t.key===e);if(r)return[r.id,r.isStatic&&r.values[l]?r.values[l]:r.value(l)];const s=b.find(t=>t.keys&&t.keys.includes(e));return s?s.value(l,e):null},ee=e=>{let l=e.split(";"),r=l.length,s={style:{}},t,o,c;for(;r--;)if(t=l[r].split(":"),o=N.exports.trim(t[0]),c=N.exports.trim(t[1]),o.length>0&&c.length>0){const a=Z(o,c);a!==null?a.length===2?s.style[a[0]]=a[1]:a.length===3&&(s.style[a]||(s.style[a[0]]={}),s.style[a[0]][a[2]]=a[1]):s.style[o]=c}return s.style},te=e=>{let{state:l}=e;(function r(s){let t=s.findIndex(c=>c.key==="span");if(t===-1)return;let o=s.slice(t);e.styles||(e.styles={current:{}}),Object.assign(e.styles.current,o[0].data),r(o.slice(1))})(l)},I=(e,l={},r=[],s=0)=>{let t={type:e.type==="node"?e.tagName:e.type,styles:{current:{}},level:s},o={};e.attrs&&(t.attributes=e.attrs,t.attributes.style&&(t.styles.current=ee(t.attributes.style),o=t.styles.current));let c={};c.key=t.type,c.data=o;const a=[...r,c];switch(e.children&&(t.children=e.children.map(f=>I(f,o,a,s+1))),t.type){case"text":t.state=a,te(t),t.value=e.text;break;case"strong":t.children[0].isStrong=!0,t=t.children[0],Object.assign(t.styles.current,l);break;case"span":let f=[],E=0;t.children=t.children.filter((d,u)=>d.children?(d.children.forEach(_=>f.push({i:u,c:_})),!1):!0),f.length>0&&f.forEach(d=>{t.children.splice(d.i+E,0,d.c),E+=1});break;case"sub":t.children[0].subScript=!0;break;case"u":t.children[0].underline=!0;break;case"s":t.children[0].strike=!0;break;default:t.__v=1}return t.state=a,t},R=(e,l={p:0})=>{let r=null;if(e.children&&(r=e.children.map(s=>R(s,l)).filter(s=>s!==null)),e.type==="root")return{section:r};if(e.type==="p"){const s=Object.entries(e.styles)[0];let t={};s!==null&&(t=s[1]);let o=[];return r.forEach(c=>{Array.isArray(c)?o=[...o,...c]:o.push(c)}),e.reference="my-crazy-numbering",e.level===1&&(l.p+=1,l.p===1?(t.heading=i.exports.HeadingLevel.HEADING_1,e.level=0):e.children[0].children&&e.children[0]&&e.children[0].children[0].isStrong&&(console.log("file: doc.service.js | line 348 | generate | x",e),console.log("file: doc.service.js | line 346 | generate | count",l),t.heading=i.exports.HeadingLevel.HEADING_2,e.level=0)),"size"in t&&(t.size*=2),new i.exports.Paragraph(g({children:o,numbering:{reference:e.reference,level:e.level}},t))}else if(e.type==="text"){const s=e;if(s.value===" ")return null;const t=Object.entries(e.styles)[0];let o={};return t!==null&&(o=t[1]),o||(o={}),o.bold=!!s.isStrong,o.subScript=!!s.subScript,s.underline&&(o.underline={}),s.strike&&(o.strike={}),"size"in o&&(o.size*=2),new i.exports.TextRun(g({text:s.value},o))}else{if(e.type==="span")return r;if(e.type==="strong"||e.type==="mfenced")return r[0];if(e.type==="sub")return r[0];if(e.type==="u")return r[0];if(e.type==="s")return r[0];if(e.type==="img")return new i.exports.TextRun({text:"(---Image here---)"});if(e.type==="comment")return new i.exports.PageBreak;if(e.type==="table")return new i.exports.Table({rows:r[0]});if(e.type==="div")return r;if(e.type==="br")return new i.exports.TextRun({text:"break",break:1});if(e.type==="tbody")return r;if(e.type==="tr")return new i.exports.TableRow({children:r});if(e.type==="td"){const s={};return Object.entries(e.attributes).forEach(([t,o])=>{t==="colspan"&&(s.columnSpan=o)}),new i.exports.TableCell(g(g({children:r},s),e.styles.current))}else{if(e.type==="math")return new i.exports.Math({children:r});if(e.type==="mi"||e.type==="mo"||e.type==="mn")return new i.exports.MathRun(e.children[0].value);if(e.type==="msqrt")return new i.exports.MathRadical({children:r});if(e.type==="msup")return new i.exports.MathSuperScript({children:[r[0]],superScript:[r[1]]});if(e.type==="msub")return new i.exports.MathSubScript({children:[r[0]],subScript:[r[1]]});if(e.type==="mrow")return r;if(e.type==="mfrac")return new i.exports.MathFraction({numerator:r[0],denominator:r[1]})}}return null},re=e=>new Promise(l=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="blob",r.onload=function(){var s=new FileReader;s.onload=function(o){var c=o.target.result;l(c)};var t=this.response;s.readAsDataURL(t)},r.send()}),ne=async e=>{const l=I(e);let r=R(l).section.filter(o=>o);F&&(await Promise.all(Object.entries(F).map(async c=>{const a={};return a[c[0]]=await re(c[1]),a}))).forEach(c=>{const a=Object.entries(c)[0],f=new i.exports.Paragraph({children:[new i.exports.PageBreak,new i.exports.TextRun({text:`Figure  ${a[0]+1}`})],alignment:i.exports.AlignmentType.CENTER});r.push(f);const E=new i.exports.Paragraph({alignment:i.exports.AlignmentType.CENTER,children:[new i.exports.ImageRun({data:a[1],transformation:{width:500,height:500}}),new i.exports.PageBreak],spacing:{before:200}});r.push(E)});const s=new i.exports.Document({styles:{listParagraph:{run:{color:"#000000",size:23},paragraph:{indent:{left:i.exports.convertInchesToTwip(0)}}}},numbering:{config:[{reference:"my-crazy-numbering",levels:[{level:0,format:i.exports.LevelFormat.DECIMAL,start:0,text:"",alignment:i.exports.AlignmentType.START,style:{paragraph:{indent:{left:i.exports.convertInchesToTwip(0),hanging:i.exports.convertInchesToTwip(.18)}}}},{level:1,format:i.exports.LevelFormat.DECIMAL,start:1,text:"[0%10%2] ",alignment:i.exports.AlignmentType.START,style:{paragraph:{indent:{left:i.exports.convertInchesToTwip(.1)}}}},{level:3,format:i.exports.LevelFormat.DECIMAL,text:"[0%20%3]",alignment:i.exports.AlignmentType.START,style:{paragraph:{indent:{left:i.exports.convertInchesToTwip(1.5),hanging:i.exports.convertInchesToTwip(1.18)}}}},{level:3,format:i.exports.LevelFormat.UPPER_LETTER,text:"%4)",alignment:i.exports.AlignmentType.START,style:{paragraph:{indent:{left:2880,hanging:2420}}}}]}]},sections:[{properties:{lineNumbers:{countBy:5,restart:i.exports.LineNumberRestartFormat.NEW_PAGE,size:10},page:{margin:{top:1500,right:1500,bottom:1500,left:1500},pageNumbers:{start:1,formatType:i.exports.NumberFormat.DECIMAL},size:{height:16839}}},headers:{default:new i.exports.Header({children:[new i.exports.Table({alignment:i.exports.AlignmentType.CENTER,width:{size:100,type:i.exports.WidthType.PERCENTAGE},rows:[new i.exports.TableRow({children:[new i.exports.TableCell({columnSpan:1,children:[new i.exports.Paragraph({children:[new i.exports.TextRun({text:"IPACTORY",size:24})],alignment:i.exports.AlignmentType.LEFT})],width:{size:33,type:i.exports.WidthType.PERCENTAGE},borders:{top:{style:i.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},bottom:{style:i.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},left:{style:i.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},right:{style:i.exports.BorderStyle.NONE,size:0,color:"FFFFFF"}}}),new i.exports.TableCell({columnSpan:1,children:[new i.exports.Paragraph({size:12,font:"Times New Roman",alignment:i.exports.AlignmentType.CENTER,children:[new i.exports.TextRun({children:[new i.exports.TextRun({text:"- ",size:24,font:"Times New Roman"}),new i.exports.TextRun({children:[i.exports.PageNumber.CURRENT],font:"Times New Roman",size:24}),new i.exports.TextRun({text:" -",size:24,font:"Times New Roman"})]})]})],verticalAlign:i.exports.VerticalAlign.CENTER,borders:{top:{style:i.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},bottom:{style:i.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},left:{style:i.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},right:{style:i.exports.BorderStyle.NONE,size:0,color:"FFFFFF"}},width:{size:33,type:i.exports.WidthType.PERCENTAGE}}),new i.exports.TableCell({columnSpan:1,children:[new i.exports.Paragraph({alignment:i.exports.AlignmentType.RIGHT,children:[new i.exports.TextRun({text:"259889523",size:24})]})],verticalAlign:i.exports.VerticalAlign.CENTER,borders:{top:{style:i.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},bottom:{style:i.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},left:{style:i.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},right:{style:i.exports.BorderStyle.NONE,size:0,color:"FFFFFF"}},width:{size:33,type:i.exports.WidthType.PERCENTAGE}})]})]})]})},children:[...r]}]}),t="application/vnd.openxmlformats-officedocument.wordprocessingml.document";return new Promise((o,c)=>i.exports.Packer.toBlob(s).then(a=>{const f=a.slice(0,a.size,t);k.exports.saveAs(f,"output.docx"),o(f)}).catch(a=>{console.error(a),c(a)}))};var C=(e,l)=>{const r=e.__vccOpts||e;for(const[s,t]of l)r[s]=t;return r};const ie={name:"TestComponent",data(){return{file:null,text:null,document:null,parsedText:null}},methods:{async submitForm(){this.document=await ne(this.parsedText),U.exports.renderAsync(this.document,document.getElementById("container")).then(()=>console.log("docx: finished"))},fileUploaded(e){const[l]=e.target.files;this.file=l;const r=new FileReader;r.onload=(()=>s=>{this.text=s.target.result.replace(/\r?\n|\r/g,"").replace(/\s\s+/g," ").replace(/>\s+</g,"><")})(),r.readAsText(l)}},watch:{text(e){e!==null&&(this.parsedText=W(e.replace(/\r?\n|\r/g,"").replace(/\s\s+/g," ").replace(/>\s+</g,"><")),this.submitForm())}}},G=e=>(B("data-v-11817458"),e=e(),Y(),e),se={class:"input"},oe=G(()=>m("label",{for:"file"},"Upload an html file",-1)),le=G(()=>m("div",{id:"container"},null,-1));function ae(e,l,r,s,t,o){return L(),O("div",se,[m("form",{onSubmit:l[1]||(l[1]=z((...c)=>o.submitForm&&o.submitForm(...c),["prevent"]))},[oe,m("input",{type:"file",id:"file",onChange:l[0]||(l[0]=(...c)=>o.fileUploaded&&o.fileUploaded(...c)),required:""},null,32)],32),le])}var ce=C(ie,[["render",ae],["__scopeId","data-v-11817458"]]);const pe={name:"AppComponent",components:{Test:ce}};function ue(e,l,r,s,t,o){const c=D("Test");return L(),O("main",null,[j(c)])}var fe=C(pe,[["render",ue]]);Q(fe).mount("#app");
