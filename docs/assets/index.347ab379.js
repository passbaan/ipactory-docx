var P=Object.defineProperty;var x=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var A=(e,a,r)=>a in e?P(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r,m=(e,a)=>{for(var r in a||(a={}))M.call(a,r)&&A(e,r,a[r]);if(x)for(var r of x(a))k.call(a,r)&&A(e,r,a[r]);return e};import{b as s,F as B,l as O,d as U,o as L,c as v,a as S,w as z,p as Y,e as D,r as j,f as Q,g as V}from"./vendor.51b4b64a.js";const H=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const l of t)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function r(t){const l={};return t.integrity&&(l.integrity=t.integrity),t.referrerpolicy&&(l.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?l.credentials="include":t.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(t){if(t.ep)return;t.ep=!0;const l=r(t);fetch(t.href,l)}};H();var n={NONE:0,OPEN_TAG:1<<1,CLOSE_TAG:1<<2,SELF_CLOSING:1<<3,ATTR_NAME:1<<4,ATTR_VALUE:1<<5,TEXT:1<<6,COMMENT:1<<7,ONELINE:1<<8,MULTILINE:1<<9,SINGLE_QUOTE:1<<10,DOUBLE_QUOTE:1<<11,STYLE_TAG:1<<12,SCRIPT_TAG:1<<13};const X=function(){var e=document.createElement("div");function a(r){return r&&typeof r=="string"&&(r=r.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,""),r=r.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),e.innerHTML=r,r=e.textContent,e.textContent=""),r}return a}();function W(e,a){var r=0,i=e[r],t=n.TEXT,l=n.NONE,c=n.NONE;function o(p,h){return p.length<=1&&!h?p===i:p===(h||e.substring(r-p.length,r))}function f(p,h){return e.substring(p,h)}function y(p){return p===t}function T(p){return p===l}var u=[0];u.set=function(p){u[u.length-1]=p},u.get=function(){return u[u.length-1]};for(var _=new function(){this[n.TEXT]={enter:function(){T(n.OPEN_TAG|n.CLOSE_TAG)||T(n.STYLE_TAG)||T(n.SCRIPT_TAG)||u.set(r)},exit:function(){var p=f(u.get(),r);!p||a.onText(p)},do:function(){o("<")&&(t=n.OPEN_TAG|n.CLOSE_TAG)}},this[n.OPEN_TAG|n.CLOSE_TAG]={enter:function(){u.push(r)},exit:function(){var p=u.pop();y(n.OPEN_TAG)&&u.set(p)},do:function(){o("!--")?t=n.COMMENT:o("/")?t=n.CLOSE_TAG:o(" ")?t=n.TEXT:!o("!")&&!o("-")&&(t=n.OPEN_TAG)}},this[n.OPEN_TAG]={exit:function(){var p=f(u.get(),r);!p||(p==="style"&&(c=n.STYLE_TAG),p==="script"&&(c=n.SCRIPT_TAG),a.onOpenTag(p))},do:function(){o(">")?t=n.SELF_CLOSING:o(" ")&&(t=n.ATTR_NAME)}},this[n.CLOSE_TAG]={enter:function(){u.set(r)},exit:function(){var p=f(u.get(),r);!p||a.onCloseTag(p)},do:function(){o(">")&&(t=n.TEXT)}},this[n.SELF_CLOSING]={enter:function(){u.push(r)},exit:function(){var p=u.pop();r=p-1,c&n.STYLE_TAG&&(t=n.OPEN_TAG|n.STYLE_TAG),c&n.SCRIPT_TAG&&(t=n.OPEN_TAG|n.SCRIPT_TAG)},do:function(){o("/>",f(r-2,r))?this.mark():this.close(),t=n.TEXT},mark:function(){a.onSelfClose()},close:function(){a.onOpenTagExit()}},this[n.ATTR_NAME]={enter:function(){u.set(r)},exit:function(){if(!o("/",f(r-1,r))){var p=f(u.get(),r);!p||a.onAttrName(p)}},do:function(){o(" ")||o("/")?this.repeat():o(">")?t=n.SELF_CLOSING:o("=")&&(t=n.ATTR_VALUE)},repeat:function(){this.exit(),u.set(r+1)}},this[n.ATTR_VALUE]={enter:function(){o("'")?(t|=n.SINGLE_QUOTE,u.set(r+1)):o('"')?(t|=n.DOUBLE_QUOTE,u.set(r+1)):u.set(r)},exit:function(){var p=f(u.get(r),r);!p||a.onAttrValue(p)},do:function(){o(" ")?t=n.ATTR_NAME:o(">")&&(t=n.SELF_CLOSING)}},this[n.ATTR_VALUE|n.SINGLE_QUOTE]={exit:this[n.ATTR_VALUE].exit,do:function(){o("'")&&(t=n.ATTR_NAME)}},this[n.ATTR_VALUE|n.DOUBLE_QUOTE]={exit:this[n.ATTR_VALUE].exit,do:function(){o('"')&&(t=n.ATTR_NAME)}},this[n.STYLE_TAG]={do:function(){o("/*")?t=n.STYLE_TAG|n.COMMENT:o("'")?t=n.STYLE_TAG|n.SINGLE_QUOTE:o('"')?t=n.STYLE_TAG|n.DOUBLE_QUOTE:o("<")&&o("</style>",f(r,r+8))&&(t=n.TEXT,r--,this.close())},close:function(){var p=u.pop();u.set(p),c^=n.STYLE_TAG}},this[n.OPEN_TAG|n.STYLE_TAG]={enter:function(){u.push(r)},do:this[n.STYLE_TAG].do},this[n.STYLE_TAG|n.COMMENT]={do:function(){o("*/")&&(t=n.STYLE_TAG)}},this[n.STYLE_TAG|n.SINGLE_QUOTE]={do:function(){o("'")&&(t=n.STYLE_TAG)}},this[n.STYLE_TAG|n.DOUBLE_QUOTE]={do:function(){o('"')&&(t=n.STYLE_TAG)}},this[n.SCRIPT_TAG]={do:function(){o("/*")?t=n.SCRIPT_TAG|n.COMMENT|n.MULTILINE:o("//")?t=n.SCRIPT_TAG|n.COMMENT|n.ONELINE:o("'")?t=n.SCRIPT_TAG|n.SINGLE_QUOTE:o('"')?t=n.SCRIPT_TAG|n.DOUBLE_QUOTE:o("`")?t=n.SCRIPT_TAG|n.MULTILINE:o("<")&&o("<\/script>",f(r,r+9))&&(t=n.TEXT,r--,this.close())},close:function(){var p=u.pop();u.set(p),c^=n.SCRIPT_TAG}},this[n.OPEN_TAG|n.SCRIPT_TAG]={enter:function(){u.push(r)},exit:this[n.SCRIPT_TAG].close,do:this[n.SCRIPT_TAG].do},this[n.SCRIPT_TAG|n.COMMENT|n.MULTILINE]={do:function(){o("*/")&&(t=n.SCRIPT_TAG)}},this[n.SCRIPT_TAG|n.COMMENT|n.ONELINE]={do:function(){o(`
`)&&(t=n.SCRIPT_TAG)}},this[n.SCRIPT_TAG|n.SINGLE_QUOTE]={do:function(){o("'")&&(t=n.SCRIPT_TAG)}},this[n.SCRIPT_TAG|n.DOUBLE_QUOTE]={do:function(){o('"')&&(t=n.SCRIPT_TAG)}},this[n.SCRIPT_TAG|n.MULTILINE]={do:function(){o("`")&&(t=n.SCRIPT_TAG)}},this[n.COMMENT]={enter:function(){u.set(r)},exit:function(){var p=f(u.get(),r-2);!p||a.onComment(p)},do:function(){o("-->",f(r-2,r+1))&&(t=n.TEXT)}}},d={},N;r<e.length;r++,i=e[r])N=!1,d=_[t],d&&(l!=t&&d.enter&&d.enter(),l=t,d.do&&(d.do(),t!=l&&d.exit&&(d.exit(),N=!0)));!N&&d.exit&&d.exit()}function C(e){(e.type==="root"||e.type==="node")&&(delete e.parent,delete e.last,e.children&&e.children.forEach(function(a){C(a)}))}function $(e){let a={"!DOCTYPE":!0,"!doctype":!0,area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,circle:!0,ellipse:!0,line:!0,path:!0,polygon:!0,polyline:!0,rect:!0,stop:!0,use:!0},r={type:"root"},i=r,t={};return t.onOpenTag=function(l){var c={type:"node",tagName:l};c.parent=i,i.children||(i.children=[]),i.children.push(c),i=c},t.onOpenTagExit=function(){a[i.tagName]&&(i=i.parent)},t.onCloseTag=function(){i=i.parent},t.onSelfClose=function(){i=i.parent},t.onAttrName=function(l){i.attrs||(i.attrs={}),i.last=l,i.attrs[l]=""},t.onAttrValue=function(l){i.attrs[i.last]=l},t.onText=function(l){i.children||(i.children=[]);var c={type:"text",text:X(l)};i.children.push(c)},t.onComment=function(l){i.children||(i.children=[]);var c={type:"comment",value:l};i.children.push(c)},W(e,t),C(r),r}var q="/public_assets/images/fig1.jpg",J="/public_assets/images/fig2.jpg",K="/public_assets/images/fig3.jpg",Z="/public_assets/images/fig4.jpg";const b=[q,J,K,Z],E=e=>e==="none"?0:e.includes("cm")?parseInt(e.replace("cm"))*566.9291338583:e.includes("pt")?parseInt(e.replace("pt"))*20:e.includes("px")?parseInt(e.replace("px"))*15:0,F=[{id:"alignment",key:"text-align",isStatic:!0,values:{center:s.exports.AlignmentType.CENTER,left:s.exports.AlignmentType.LEFT,right:s.exports.AlignmentType.RIGHT,justify:s.exports.AlignmentType.JUSTIFIED}},{id:"color",key:"color",isStatic:!1,value:e=>e.replace("#","")},{id:"font",key:"font-family",isStatic:!1,value:e=>e},{id:"size",key:"font-size",isStatic:!1,value:e=>parseFloat(e.replace("pt",""))},{id:"indent",key:"text-indent",isStatic:!1,value:e=>({start:E(e)})},{id:"indent",key:"padding",isStatic:!1,value:e=>{const a=e.split(" ");return{top:E(a[0]),right:E(a[1]),bottom:E(a[2]),left:E(a[3])}}},{id:"shading",key:"background-color",isStatic:!1,value:e=>({type:s.exports.ShadingType.CLEAR,fill:e.replace("#","")})},{id:"width",key:"width",isStatic:!1,value:e=>({size:E(e),type:s.exports.WidthType.DXA})},{id:"spacing",key:"line-height",isStatic:!1,value:e=>({line:typeof e=="string"?240:parseFloat((e*240/100).toFixed(2))})},{id:"borders",key:"border",keys:["border-right","border-left","border-top","border-bottom"],isStatic:!1,value:(e,a="border")=>{const r={top:{style:s.exports.BorderStyle.NONE,size:0},bottom:{style:s.exports.BorderStyle.NONE,size:0},left:{style:s.exports.BorderStyle.NONE,size:0},right:{style:s.exports.BorderStyle.NONE,size:0}};if(a==="border"){if(e==="none")return r}else{const i=a.replace("border-","");let t=0;if(e!=="none"){const l=e.split(" ");t=E(l[2])}return["borders",{style:t!==0?s.exports.BorderStyle.SINGLE:s.exports.BorderStyle.NONE,size:t},i]}}}],ee=(e,a)=>{const r=F.find(t=>t.key===e);if(r)return[r.id,r.isStatic&&r.values[a]?r.values[a]:r.value(a)];const i=F.find(t=>t.keys&&t.keys.includes(e));return i?i.value(a,e):null},te=e=>{let a=e.split(";"),r=a.length,i={style:{}},t,l,c;for(;r--;)if(t=a[r].split(":"),l=O.exports.trim(t[0]),c=O.exports.trim(t[1]),l.length>0&&c.length>0){const o=ee(l,c);o!==null?(i.style[o[0]]||(i.style[o[0]]={}),o.length===2?o[0]==="borders"?Object.entries(o[1]).forEach(([f,y])=>{i.style[o[0]][f]||(i.style[o[0]][f]=y)}):i.style[o[0]]=o[1]:o.length===3&&(i.style[o[0]][o[2]]=o[1])):i.style[l]=c}return i.style},g=e=>{let{state:a}=e;(function r(i){let t=i.findIndex(c=>c.key==="span");if(t===-1)return;let l=i.slice(t);e.styles||(e.styles={current:{}}),Object.assign(e.styles.current,l[0].data),r(l.slice(1))})(a)},G=(e,a={},r=[],i=0)=>{let t={type:e.type==="node"?e.tagName:e.type,styles:{current:{}},level:i},l={};e.attrs&&(t.attributes=e.attrs,t.attributes.style&&(t.styles.current=te(t.attributes.style),l=t.styles.current));let c={};c.key=t.type,c.data=l;const o=[...r,c];switch(e.children&&(t.children=e.children.map(f=>G(f,l,o,i+1))),t.type){case"text":t.state=o,g(t),t.value=e.text;break;case"strong":t.children[0].isStrong=!0,t=t.children[0],Object.assign(t.styles.current,a);break;case"span":let f=[],y=0;t.children=t.children.filter((T,u)=>T.children?(T.children.forEach(_=>f.push({i:u,c:_})),!1):!0),f.length>0&&f.forEach(T=>{t.children.splice(T.i+y,0,T.c),y+=1});break;case"sub":g(t.children[0]),t.children[0].subScript=!0;break;case"u":g(t.children[0]),t.children[0].underline=!0;break;case"s":g(t.children[0]),t.children[0].strike=!0;break;default:t.__v=1}return t.state=o,t},I=(e,a={p:0})=>{let r=null;if(e.children&&(r=e.children.map(i=>I(i,a)).filter(i=>i!==null)),e.type==="root")return{section:r};if(e.type==="p"){const i=Object.entries(e.styles)[0];let t={};i!==null&&(t=i[1]);let l=[];return r.forEach(c=>{Array.isArray(c)?l=[...l,...c]:l.push(c)}),e.reference="my-crazy-numbering",e.level===1&&(a.p+=1,a.p===1?(t.heading=s.exports.HeadingLevel.HEADING_1,e.level=0):e.children[0]&&e.children[0].children&&e.children[0].children[0].isStrong&&(e.children[0].children[0].value.toLowerCase()==="claims"?e.level=2:e.level=0,t.heading=s.exports.HeadingLevel.HEADING_2)),"size"in t&&(t.size*=2),new s.exports.Paragraph(m({children:l,numbering:{reference:e.reference,level:e.level}},t))}else if(e.type==="text"){const i=e;if(i.value===" ")return null;const t=Object.entries(e.styles)[0];let l={};return t!==null&&(l=t[1]),l||(l={}),l.bold=!!i.isStrong,l.subScript=!!i.subScript,i.underline&&(l.underline={}),i.strike&&(l.strike={}),"size"in l&&(l.size*=2),new s.exports.TextRun(m({text:i.value},l))}else{if(e.type==="span")return r;if(e.type==="strong"||e.type==="mfenced")return r[0];if(e.type==="sub")return r[0];if(e.type==="u")return r[0];if(e.type==="s")return r[0];if(e.type==="img")return new s.exports.TextRun({text:"(---Image here---)"});if(e.type==="comment")return new s.exports.PageBreak;if(e.type==="table")return new s.exports.Table({rows:r[0],borders:{top:{style:s.exports.BorderStyle.NONE},left:{style:s.exports.BorderStyle.NONE},right:{style:s.exports.BorderStyle.NONE},bottom:{style:s.exports.BorderStyle.NONE}}});if(e.type==="div")return r;if(e.type==="br")return new s.exports.TextRun({text:"break",break:1});if(e.type==="tbody")return r;if(e.type==="tr")return new s.exports.TableRow({children:r,borders:{top:{style:s.exports.BorderStyle.NONE},left:{style:s.exports.BorderStyle.NONE},right:{style:s.exports.BorderStyle.NONE},bottom:{style:s.exports.BorderStyle.NONE}}});if(e.type==="td"){const i={};return Object.entries(e.attributes).forEach(([t,l])=>{t==="colspan"&&(i.columnSpan=l)}),new s.exports.TableCell(m(m({children:r},i),e.styles.current))}else{if(e.type==="math")return new s.exports.Math({children:r});if(e.type==="mi"||e.type==="mo"||e.type==="mn")return new s.exports.MathRun(e.children[0].value);if(e.type==="msqrt")return new s.exports.MathRadical({children:r});if(e.type==="msup")return new s.exports.MathSuperScript({children:[r[0]],superScript:[r[1]]});if(e.type==="msub")return new s.exports.MathSubScript({children:[r[0]],subScript:[r[1]]});if(e.type==="mrow")return r;if(e.type==="mfrac")return new s.exports.MathFraction({numerator:r[0],denominator:r[1]})}}return null},re=e=>new Promise(a=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="blob",r.onload=function(){var i=new FileReader;i.onload=function(l){var c=l.target.result;a(c)};var t=this.response;i.readAsDataURL(t)},r.send()}),ne=async e=>{const a=G(e);let r=I(a).section.filter(l=>l);b&&(await Promise.all(Object.entries(b).map(async c=>{const o={};return o[c[0]]=await re(c[1]),o}))).forEach(c=>{const o=Object.entries(c)[0],f=new s.exports.Paragraph({children:[new s.exports.PageBreak,new s.exports.TextRun({text:`Figure  ${o[0]+1}`})],alignment:s.exports.AlignmentType.CENTER,level:4});r.push(f);const y=new s.exports.Paragraph({alignment:s.exports.AlignmentType.CENTER,children:[new s.exports.ImageRun({data:o[1],transformation:{width:500,height:500}}),new s.exports.PageBreak],spacing:{before:200}});r.push(y)});const i=new s.exports.Document({styles:{listParagraph:{run:{color:"#000000",size:23},paragraph:{indent:{left:s.exports.convertInchesToTwip(0)}}}},numbering:{config:[{reference:"my-crazy-numbering",levels:[{level:0,format:s.exports.LevelFormat.DECIMAL,start:0,text:"",alignment:s.exports.AlignmentType.START,style:{paragraph:{indent:{left:s.exports.convertInchesToTwip(0)}}}},{level:1,format:s.exports.LevelFormat.DECIMAL,start:1,text:"[0%10%2] ",alignment:s.exports.AlignmentType.START,style:{paragraph:{indent:{left:s.exports.convertInchesToTwip(.1)}}}}]}]},sections:[{properties:{lineNumbers:{countBy:5,restart:s.exports.LineNumberRestartFormat.NEW_PAGE,size:10},page:{margin:{top:1500,right:1500,bottom:1500,left:1500},pageNumbers:{start:1,formatType:s.exports.NumberFormat.DECIMAL},size:{height:16839}}},headers:{default:new s.exports.Header({children:[new s.exports.Table({alignment:s.exports.AlignmentType.CENTER,width:{size:100,type:s.exports.WidthType.PERCENTAGE},rows:[new s.exports.TableRow({children:[new s.exports.TableCell({columnSpan:1,children:[new s.exports.Paragraph({children:[new s.exports.TextRun({text:"IPACTORY",size:24})],alignment:s.exports.AlignmentType.LEFT})],width:{size:33,type:s.exports.WidthType.PERCENTAGE},borders:{top:{style:s.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},bottom:{style:s.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},left:{style:s.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},right:{style:s.exports.BorderStyle.NONE,size:0,color:"FFFFFF"}}}),new s.exports.TableCell({columnSpan:1,children:[new s.exports.Paragraph({size:12,font:"Times New Roman",alignment:s.exports.AlignmentType.CENTER,children:[new s.exports.TextRun({children:[new s.exports.TextRun({text:"- ",size:24,font:"Times New Roman"}),new s.exports.TextRun({children:[s.exports.PageNumber.CURRENT],font:"Times New Roman",size:24}),new s.exports.TextRun({text:" -",size:24,font:"Times New Roman"})]})]})],verticalAlign:s.exports.VerticalAlign.CENTER,borders:{top:{style:s.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},bottom:{style:s.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},left:{style:s.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},right:{style:s.exports.BorderStyle.NONE,size:0,color:"FFFFFF"}},width:{size:33,type:s.exports.WidthType.PERCENTAGE}}),new s.exports.TableCell({columnSpan:1,children:[new s.exports.Paragraph({alignment:s.exports.AlignmentType.RIGHT,children:[new s.exports.TextRun({text:"259889523",size:24})]})],verticalAlign:s.exports.VerticalAlign.CENTER,borders:{top:{style:s.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},bottom:{style:s.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},left:{style:s.exports.BorderStyle.NONE,size:0,color:"FFFFFF"},right:{style:s.exports.BorderStyle.NONE,size:0,color:"FFFFFF"}},width:{size:33,type:s.exports.WidthType.PERCENTAGE}})]})]})]})},children:[...r]}]}),t="application/vnd.openxmlformats-officedocument.wordprocessingml.document";return new Promise((l,c)=>s.exports.Packer.toBlob(i).then(o=>{const f=o.slice(0,o.size,t);B.exports.saveAs(f,"output.docx"),l(f)}).catch(o=>{console.error(o),c(o)}))};var R=(e,a)=>{const r=e.__vccOpts||e;for(const[i,t]of a)r[i]=t;return r};const se={name:"TestComponent",data(){return{file:null,text:null,document:null,parsedText:null}},methods:{async submitForm(){this.document=await ne(this.parsedText),U.exports.renderAsync(this.document,document.getElementById("container")).then(()=>console.log("docx: finished"))},fileUploaded(e){const[a]=e.target.files;this.file=a;const r=new FileReader;r.onload=(()=>i=>{this.text=i.target.result.replace(/\r?\n|\r/g,"").replace(/\s\s+/g," ").replace(/>\s+</g,"><")})(),r.readAsText(a)}},watch:{text(e){e!==null&&(this.parsedText=$(e.replace(/\r?\n|\r/g,"").replace(/\s\s+/g," ").replace(/>\s+</g,"><")),this.submitForm())}}},w=e=>(Y("data-v-11817458"),e=e(),D(),e),ie={class:"input"},oe=w(()=>S("label",{for:"file"},"Upload an html file",-1)),le=w(()=>S("div",{id:"container"},null,-1));function ae(e,a,r,i,t,l){return L(),v("div",ie,[S("form",{onSubmit:a[1]||(a[1]=z((...c)=>l.submitForm&&l.submitForm(...c),["prevent"]))},[oe,S("input",{type:"file",id:"file",onChange:a[0]||(a[0]=(...c)=>l.fileUploaded&&l.fileUploaded(...c)),required:""},null,32)],32),le])}var ce=R(se,[["render",ae],["__scopeId","data-v-11817458"]]);const pe={name:"AppComponent",components:{Test:ce}};function ue(e,a,r,i,t,l){const c=j("Test");return L(),v("main",null,[Q(c)])}var fe=R(pe,[["render",ue]]);V(fe).mount("#app");
